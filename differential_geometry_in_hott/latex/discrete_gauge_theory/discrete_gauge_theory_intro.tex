\section{Overview}
We will define 
\begin{itemize}
\item combinatorial 2-manifolds
\item principal circle bundles of tangent bundles
\item vector fields,
\end{itemize}
and then observe emerging from those definitions the presence of
\begin{itemize}
\item connections
\item curvature
\item the index of a vector field,
\end{itemize}
and prove
\begin{itemize}
\item the Leibniz formula
\item the Gauss-Bonnet theorem
\item and the Poincaré-Hopf theorem.
\end{itemize}

We will consider functions \( M\to \EM(\zz,1) \) where \( \EM(\zz,1) \) is the connected component in the universe of the Eilenberg-MacLane space \( \K(\zz,1) \) which we will take to be \( \so \), and where \( M \) is a combinatorial manifold of dimension 2, which is a simplicial complex encoded in a higher inductive type, such that each vertex has a neighborhood that looks like a disk with a discrete circle boundary (i.e. a polygon). We can call terms \( C:\EM(\zz,1) \) ``mere circles.''

Note that \( \EM(\zz,1) \) contains all the polygons. Therefore we can construct a map \( T:M\to\EM(\zz,1) \) that maps each vertex to the polygon consisting of its neighbors. This will serve as the circle bundle of the tangent bundle of the manifold, i.e. the principal bundle consisting of nonzero tangent vectors.

Now consider the type \( \EMp(\zz,1)\defeq \sit{Y:\EM(\zz,1)}Y \) of pointed mere circles. We have the pullback
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJQXFxzdGFja3JlbHtcXG1hdGhybXtkZWZ9fXs9fVxcc3VtX3tDOlRNfUMiXSxbMSwwLCJcXG1hdGhybXtFTX1fXFxidWxsZXQoXFxtYXRoYmJ7Wn0sMSkiXSxbMSwxLCJcXG1hdGhybXtFTX0oXFxtYXRoYmJ7Wn0sMSkiXSxbMCwxLCJNIl0sWzAsMywiXFxtYXRocm17cHJ9XzEiLDJdLFsxLDIsIlxcbWF0aHJte3ByfV8xIiwyXSxbMCwxLCJcXG92ZXJsaW5le1R9Il0sWzMsMiwiVCJdLFswLDIsIiIsMSx7InN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dXQ==
\begin{center}
\begin{tikzcd}[cramped]
  {P\stackrel{\mathrm{def}}{=}\sum_{C:TM}C} & {\mathrm{EM}_\bullet(\mathbb{Z},1)} \\
  M & {\mathrm{EM}(\mathbb{Z},1)}
  \arrow["{\overline{T}}", from=1-1, to=1-2]
  \arrow["{\mathrm{pr}_1}"', from=1-1, to=2-1]
  \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
  \arrow["{\mathrm{pr}_1}"', from=1-2, to=2-2]
  \arrow["T", from=2-1, to=2-2]
\end{tikzcd}
\end{center}
from the univalent fibration on the right, forming the usual fiber of \( T \) as a sigma type. Such classifying maps are not always principal bundles; there is an extra condition on \( T \) that we will get into later. For now it's important only that we are mapping into a univalent fibration so that we can make use of type theory. Univalent fibrations are always equivalent to a projection of a type of pointed types to some connected component of the universe\cite{christensen_univalence}.

We will investigate that the data in dimensions 1 and 2 of \( T \) can be thought of as a connection, notably one that is not necessarily flat. Moreover, lifting \( T \) to \( \EMp(\zz,1) \) can be thought of as a vector field. There will in general not be a total lift, just a partial function. The domain will have a boundary of circles, and the winding number on these can be thought of as the index of the vector field. We can then examine the total curvature and the total index and prove that they are equal, and equal to the usual Euler characteristic. This will simultaneously prove the Poincaré-Hopf theorem and Gauss-Bonnet theorem in 2 dimensions, for combinatorial manifolds. This is similar to the classical proof of Hopf\cite{hopf}, presented in detail in Needham\cite{needham}.

Taking the dimension 1 part of a function can be thought of as its derivative (``\( \ap \) is \( d \)''). If the codomain has an H-space structure then we can ask about how the action on paths interacts with pointwise multiplication. This will lead us to the Leibniz formula in this context, which emerges simply from horizontal composition in the codomain. This also implies that we can view a connection as the derivative of a bundle classifying map.

\subsection{Future work}
The results of this note can be extended in many directions. There are higher-dimensional generalizations of Gauss-Bonnet, including the theory of characteristic classes and Chern-Weil theory (which links characteristic classes to connections and curvature). Results from gauge theory could be imported into HoTT, as well as results from surgery theory and other topological constructions that may be especially amenable to this discrete setting. Finally, a theory that reintroduces smoothness could allow more formal versions of the analogies explored here. 
