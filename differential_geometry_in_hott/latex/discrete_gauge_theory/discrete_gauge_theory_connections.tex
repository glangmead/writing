\section{Bundles, connections, and curvature}
Bundles are simply maps into the universe. By using the extra cellular structure and the even more detailed combinatorial structure of higher realizations, we can identify inside of HoTT some additional classical definitions.

\subsection{Definitions}
Having the cellular structure allows us to define bundles and connections.
\begin{mydef}
\label{def:connection}
If \( \mm_0\xrightarrow[]{\imath_0}\cdots\xrightarrow[]{\imath_{n-1}}\mm_n \) is a cellular type and \( f_k:\mm_k\to\uni \) are type families on each skeleton such that all the triangles commute in the diagram:
\end{mydef}
\begin{center}
% https://q.uiver.app/#q=WzAsNixbMCwwLCJcXG1hdGhiYntNfV8wIl0sWzEsMCwiXFxtYXRoYmJ7TX1fMSJdLFsyLDAsIlxcbWF0aGJie019XzIiXSxbNCwwLCJcXG1hdGhiYntNfSJdLFszLDAsIlxcY2RvdHMiXSxbMiwxLCJcXG1hdGhjYWx7VX0iXSxbMCwxLCJcXGltYXRoXzAiXSxbMSwyLCJcXGltYXRoXzEiXSxbMiw0LCJcXGltYXRoXzIiXSxbNCwzLCJcXGltYXRoX3tuLTF9Il0sWzAsNSwiZl8wIl0sWzEsNSwiZl8xIl0sWzIsNSwiZl8yIl0sWzMsNSwiZiIsMl1d
\begin{tikzcd}
  {\mm_0} & {\mm_1} & {\mm_2} & \cdots & {\mm} \\
  && {\mathcal{U}}
  \arrow["{\imath_0}", from=1-1, to=1-2]
  \arrow["{f_0}", from=1-1, to=2-3]
  \arrow["{\imath_1}", from=1-2, to=1-3]
  \arrow["{f_1}", from=1-2, to=2-3]
  \arrow["{\imath_2}", from=1-3, to=1-4]
  \arrow["{f_2}", from=1-3, to=2-3]
  \arrow["{\imath_{n-1}}", from=1-4, to=1-5]
  \arrow["f"', from=1-5, to=2-3]
\end{tikzcd}
\end{center}
then we say
\begin{itemize}
\item The map \( f_k \) is a \defemph{\( k \)-bundle} on \( \mm_k \).
\item The pair given by the map \( f_k \) and the proof \( f_k\circ \imath_{k-1}=f_{k-1} \) that \( f_k \) extends \( f_{k-1} \) is called a \defemph{\( k \)-connection on the bundle \( f_{k-1} \)}.
\end{itemize}

Having the additional structure of a simplicial complex allows us to further define curvature, which is a local concept.

\begin{mydef}
If \( \hgr{M} \) is a higher combinatorial \( n \)-manifold as above, and such that for each pushout defining \( \mm_k \) we have the diagram
\end{mydef}
\begin{center}
% https://q.uiver.app/#q=WzAsNSxbMCwxLCJcXG1hdGhiYntNfV97ay0xfSJdLFswLDAsIk1fa1xcdGltZXMgU15rIl0sWzEsMCwiTV9rIl0sWzEsMSwiXFxtYXRoYmJ7TX1fayJdLFsxLDIsIlxcbWF0aGNhbHtVfSJdLFswLDNdLFsxLDAsIlxccGFydGlhbF97ay0xfSIsMl0sWzIsMywiKl9rIl0sWzEsMiwiXFxtYXRocm17cHJ9XzEiXSxbMywxLCIiLDEseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyLWludmVyc2UifX1dLFswLDIsImhfayIsMCx7InNob3J0ZW4iOnsic291cmNlIjo0MCwidGFyZ2V0Ijo0MH0sImxldmVsIjoyfV0sWzMsNCwiZl9rIl0sWzAsNCwiZl97ay0xfSIsMl0sWzMsMTIsIiIsMCx7InNob3J0ZW4iOnsidGFyZ2V0IjoyMH19XV0=
\begin{tikzcd}
  {M_k\times S^k} & {M_k} \\
  {\mm_{k-1}} & {\mm_k} \\
  & {\mathcal{U}}
  \arrow["{\mathrm{pr}_1}", from=1-1, to=1-2]
  \arrow["{\partial_{k-1}}"', from=1-1, to=2-1]
  \arrow["{*_k}", from=1-2, to=2-2]
  \arrow["{h_k}", shorten <=9pt, shorten >=9pt, Rightarrow, from=2-1, to=1-2]
  \arrow[from=2-1, to=2-2]
  \arrow[""{name=0, anchor=center, inner sep=0}, "{f_{k-1}}"', from=2-1, to=3-2]
  \arrow["\ulcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=1-1]
  \arrow["{f_k}", from=2-2, to=3-2]
  \arrow[shorten >=2pt, Rightarrow, from=2-2, to=0]
\end{tikzcd}
\end{center}

the outer square of which restricts on each face to the diagram

\begin{center}
% https://q.uiver.app/#q=WzAsNCxbMCwxLCJcXG1hdGhiYntNfV97ay0xfSJdLFswLDAsIlxce21fa1xcfVxcdGltZXMgU15rIl0sWzEsMCwibV9rIl0sWzEsMSwiXFxtYXRoY2Fse1V9Il0sWzAsM10sWzEsMCwiXFxwYXJ0aWFsX3trLTF9IiwyXSxbMiwzLCJmX2tcXGNpcmMqX2siXSxbMSwyLCIhIl0sWzAsMiwiXFxmbGF0X2siLDAseyJzaG9ydGVuIjp7InNvdXJjZSI6NDAsInRhcmdldCI6NDB9LCJsZXZlbCI6Mn1dXQ==
\begin{tikzcd}
  {\{m_k\}\times S^k} & {m_k} \\
  {\mm_{k-1}} & {\mathcal{U}}
  \arrow["{!}", from=1-1, to=1-2]
  \arrow["{\partial_{k-1}}"', from=1-1, to=2-1]
  \arrow["{f_k\circ*_k}", from=1-2, to=2-2]
  \arrow["{\flat_k}", shorten <=10pt, shorten >=10pt, Rightarrow, from=1-2, to=2-1]
  \arrow[from=2-1, to=2-2]
\end{tikzcd}
\end{center}
then we say the filler \( \flat_k \) is called a \defemph{flatness structure for the face \( m_k \)}, or, to align with classical terms, the \defemph{curvature at the face \( m_k \)}, and its ending path is called the \defemph{holonomy around the face}.

The definitions can be digested to give
\begin{mylemma}
Given \( f_{k-1} \) as above, a \( k \)-connection exists if and only if there exists a flatness structure for each \( k \)-face.
\end{mylemma}

\begin{mynote}
Another classical object we can identify here is a \emph{gauge transformation}, which is a bundle automorphism \( H:f\sim f\defeq \pit{m:\mm}f(m)=f(m) \). If we have \( ||H=\id_f||_{-1} \) then the gauge transformation is called \emph{small}, else \emph{large}.
\end{mynote}

\subsection{Connections as local trivializations}
This section can ve viewed as an extended remark. The observation we want to make is that the data of a \( 1 \)-bundle is related to the construction of local trivializations: the fiber at one vertex can be extended throughout a single face coherently, using the connection (the extension of the classifying map to the edges) to specify isomorphisms with the fibers at the other points, and the higher connections to establish commutativity between these. 

We introduce a notation more suitable for the algebra of charts and overlaps: denote by \( g_{ji}:Ti\to Tj \) the isomorphism of transport along an edge \( e_{ij}:i=_\mm j \). The indices are ordered from right to left, which is compatible with function composition notation. Denote the inverse function by swapping indices: \( g_{ij}\defeq g_{ji}^{-1} \). Assume we have some fixed isomporphism \( T_i=S^1 \), and to avoid composing everything with this function we will assume it is \( \id \). In the diagram below we see the data arranged so that our bundles fibers are on the left, and the fiber of a trivial bundle is on the right. 
\begin{center}
% https://q.uiver.app/#q=WzAsNixbMCwwLCJUaSJdLFswLDEsIlRqIl0sWzAsMiwiVGsiXSxbMSwwLCJTXjEiXSxbMSwxLCJTXjEiXSxbMSwyLCJTXjEiXSxbMCwzLCJcXG1hdGhybXtpZH0iLDAseyJsZXZlbCI6Miwic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFswLDEsImdfe2ppfSIsMl0sWzEsMiwiZ197a2p9IiwyXSxbMSw0LCJnX3tpan0iLDJdLFsyLDUsImdfe2lqfWdfe2prfSIsMl0sWzMsNCwiIiwwLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbNCw1LCIiLDAseyJsZXZlbCI6Miwic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFswLDIsImdfe2tpfSIsMix7ImN1cnZlIjozfV0sWzMsNSwiIiwxLHsiY3VydmUiOi0zLCJsZXZlbCI6Miwic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFsxLDEzLCJcXGZsYXRfe2lqa30iLDIseyJzaG9ydGVuIjp7InRhcmdldCI6MjB9fV0sWzQsMTQsIiIsMSx7InNob3J0ZW4iOnsidGFyZ2V0IjoyMH0sInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XV0=
\begin{tikzcd}
  Ti & {S^1} \\
  Tj & {S^1} \\
  Tk & {S^1}
  \arrow["{\mathrm{id}}", equals, from=1-1, to=1-2]
  \arrow[swap, "{g_{ji}}"', from=1-1, to=2-1]
  \arrow[""{name=0, anchor=center, inner sep=0}, "{g_{ki}}"', curve={height=40pt}, from=1-1, to=3-1]
  \arrow[equals, from=1-2, to=2-2]
  \arrow[""{name=1, anchor=center, inner sep=0}, curve={height=-40pt}, equals, from=1-2, to=3-2]
  \arrow[swap, "{g_{ij}}"', from=2-1, to=2-2]
  \arrow[swap, "{g_{kj}}"', from=2-1, to=3-1]
  \arrow[equals, from=2-2, to=3-2]
  \arrow[swap, "{g_{ij}g_{jk}}"', from=3-1, to=3-2]
  \arrow["{\flat_{ijk}}"', shorten >=2pt, Rightarrow, from=2-1, to=0]
  \arrow[shorten >=2pt, equals, from=2-2, to=1]
  \arrow[shorten =12pt, equals, from=2-1, to=1-2]
  \arrow[shorten =12pt, equals, from=3-1, to=2-2]
\end{tikzcd}
\end{center}
The two middle squares commute definitionally. Call these two squares together the back face. The left triangular filler is filled by the flatness structure on the face, and the right triangular filler is trivial. There is also a filler needed for the front, i.e. the outer square. This requires proving that \( g_{ki}g_{ij}g_{jk}=\id \), which is supplied by the flatness structure. There is also a 3-cell filling the interior of this prism, mapping the back face plus the left triangle filler to the front face plus the right triangle filler. These two faces both consist of one or two identities concatenated with the flatness structure, and so the 3-cell is definitional.

This relationship between flatness structure and local triviality of a chart can be compared to the classical result that on a paracompact, simply connected manifold (such as a single chart), a connection on a principal bundle is flat if and only if the bundle is trivial. See for example \cite{kobayashinomizu} Corollary 9.2.

\subsection{The tangent bundle of the sphere}
We will build up a map \( T \) out of \( \oo_0\to\oo_1\to\oo \) which is meant to be a model of the tangent bundle of the sphere. The link function will serve as our approximation to the tangent space. Taking the link of a vertex gives us a map from vertices to polygons, so the codomain is \( \EMzo \).

\begin{mydef}
\( T_0\defeq\link:\oo_0\to\EMzo \) is given by:
\begin{align*}
\link(w) &= \hgr{brgo}_1 & \link(r) &= \hgr{wbyg}_1 \\
\link(y) &= \hgr{bogr}_1 & \link(g) &= \hgr{wryo}_1 \\
\link(b) &= \hgr{woyr}_1 & \link(o) &= \hgr{wgyb}_1
\end{align*}
Recall that the double-brackets denote the realization via pushouts of the combinatorial data, and the subscript takes the bare type of maximal dimension, forgetting the cellular structure. So \( T_0 \) is a composition of a map into \( \simcompt \) follows by the realization map to \( \EMzo \).

We chose these orderings for the vertices in the link, by visualizing standing at the given vertex as if it were the north pole, then looking south and enumerating the link in clockwise order, starting from \( w \) if possible, else \( b \).
\end{mydef}

\begin{figure}[h]
\centering
\input{figs/discrete_gauge_theory_oo_transport_tikz}
\caption{\( \link \) for the vertices \( w, b\) and \( r \).}
\label{fig:triangle_of_equators}
\end{figure}

To extend \( T_0 \) to a function \( T_1 \) on the 1-skeleton we have some freedom. We will do something motivated by the figures we have been drawing of an octahedron embedded in 3-dimensional space. We will imagine how \( T_1 \) changes as we slide from point to point in the embedding shown in the figures. Sliding from \( w \) to \( b \) and tipping the link as we go, we see \( r\mapsto r \) and \( o\mapsto o \) because those lie on the axis of rotation. Then \( g\mapsto w \) and \( b\mapsto y \). 

\begin{mydef}
Define \( T_1:\oo_1\to\EMzo \) on just the 1-skeleton by extending \( T_0 \) as follows:
Transport away from \( w \):
\begin{itemize}
\item \( T_1(wr):\hgr{brgo}_1\mapsto \hgr{bygw}_1 \) (\( b, g \) fixed)
\item \( T_1(wg):\hgr{brgo}_1\mapsto \hgr{wryo}_1 \)
\item \( T_1(wb):\hgr{brgo}_1\mapsto \hgr{yrwo}_1 \) (\( r, o \) fixed)
\item \( T_1(wo):\hgr{brgo}_1\mapsto \hgr{bwgy}_1 \)
\end{itemize}
Transport away from \( y \):
\begin{itemize}
\item \( T_1(yb):\hgr{bogr}_1\mapsto \hgr{woyr}_1 \)
\item \( T_1(yr):\hgr{bogr}_1\mapsto \hgr{bygw}_1 \)
\item \( T_1(yg):\hgr{bogr}_1\mapsto \hgr{yowr}_1 \)
\item \( T_1(yo):\hgr{bogr}_1\mapsto \hgr{bwgy}_1 \)
\end{itemize}
Transport along the equator:
\begin{itemize}
\item \( T_1(br):\hgr{woyr}_1\mapsto \hgr{wbyg}_1 \) 
\item \( T_1(rg):\hgr{wbyg}_1\mapsto \hgr{wryo}_1 \)
\item \( T_1(go):\hgr{wryo}_1\mapsto \hgr{wgyb}_1 \)
\item \( T_1(ob):\hgr{wgyb}_1\mapsto \hgr{woyr}_1 \)
\end{itemize}
\end{mydef}

It's very important to be able to visualize what \( T_1 \) does to triangular paths such as \( wb\cdot br\cdot rw \) (which circulates around the boundary of face \( wbr \)). You can see it if you imagine Figure~\ref{fig:triangle_of_equators} as the frames of a short movie. Or you can place your palm over the top of a cube and note where your fingers are pointing, then slide your hand to an equatorial face, then along the equator, then back to the top. The answer is: you come back rotated clockwise by a quarter-turn. 

\begin{mydef}
\label{def:octahedron_holonomy}
The map \( R:C_4\to C_4 \) rotates by one quarter turn, one ``click":
\begin{multicols}{2}
\begin{itemize}
\item \( R(c_1) = c_2 \)
\item \( R(c_2) = c_3 \)
\item \( R(c_3) = c_4 \)
\item \( R(c_4) = c_1 \)
\item \( R(c_1c_2) = c_2c_3 \)
\item \( R(c_2c_3) = c_3c_4 \)
\item \( R(c_3c_4) = c_4c_1 \)
\item \( R(c_4c_1) = c_1c_2 \)
\end{itemize}
\end{multicols}
\end{mydef}

Note by univalence the equivalence \( R \) gives a loop in the universe, a term of \( C_4=_{\EMzo}C_4 \).

Now let's extend \( T_1 \) to all of \( \oo \) by providing values for the eight faces. The face \( wbr \) is a path from \( \refl_w \) to the concatenation \( wb\cdot br\cdot rw \), and so the image of \( wbr \) under the extended version of \( T_1 \) must be a homotopy from \( \refl_{T_1(w)} \) to \( T_1(wb\cdot br\cdot rw) \). Here \emph{there is no additional freedom}.

\begin{mydef}
\label{def:octahedron_curvature}
Define \( T_2:\oo\to\EMzo \) by extending \( T_1 \) to the faces as follows:
\begin{multicols}{2}
\begin{itemize}
\item \( T_2(wbr)=H_R \) 
\item \( T_2(wrg)=H_R \)
\item \( T_2(wgo)=H_R \)
\item \( T_2(ybo)=H_R \)
\item \( T_2(yrb)=H_R \) 
\item \( T_2(ygr)=H_R \)
\item \( T_2(yog)=H_R \)
\item \( T_2(ybo)=H_R \)
\end{itemize}
\end{multicols}
where \( H_R:R=\refl_{C_4} \) is the obvious homotopy given by composition with \( R^{-1} \). Passing through univalence we get a 2-path between \( R \) and \( \refl \) in the loop space \( C_4=_{\EMzo}C_4 \).
\end{mydef}

\subsection{Existence of connections}

How confident can we be that we can always define a connection on an arbitrary combinatorial manifold? Two things make the octahedron example special: the link is a 4-gon at every vertex, and every edge extends to a symmetry of the entire octahedron, embedded in 3-dimensional space. This imposed a coherence on the interactions of all the choices we made for the connection, which we can worry may not exist for more complex combinatorial data.

We know as a fact outside of HoTT that any combinatorial surface that has been realized as a triangulated surface embedded in 3-dimensional euclidean space can inherit the parallel transport entailed in the embedding. We could then approximate that data to arbitrary precision with enough subdivision of the fibers of \( T \).

What would a proof inside of HoTT look like? We will leave this as an open question.

